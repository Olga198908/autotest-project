# Варианты архитектуры проекта авто-тестов
* Рассматриваются варианты архитектур Page Object Model (далее просто POM) стандарта

## Архитектура POM классическая
* Самый распространённый формат директорий
* Строгое разделение POM моделей от локаторов и данных
<details><summary>==[НАЖМИ]== Структура директорий</summary><p>

```
/Autotest-Project/                  # корневой каталог (репозиторий) проекта авто-тестов
├── /pages/                          # page object модели│ 
│   ├── base_page.py                # базовый page object класс (основные методы работы со страницей)
│   └── __init__.py
├── /test/                          # тестовые сценарии с группировкой по видам
│   ├── /smoke/                     # дымы (фронт)
│   │  ├── __int__.py   
│   │  └── test_smoke_orange.py
│   ├── /accept/                    # приемка (фронт)
│   │ 
│   ├── /api/                       # апи (бэк)
│   │   └── orange_playwright_api.py
│   ├── /load/                      # нагрузочное (locust)
│   │   ├── locust_orange.py
│   │   └── __init__.py 
│   ├── __init__.py  
│   └── conftest.py             # фикстуры pytest для конфигурации тестов и отчетности allure
├── /config/                        
│   ├── /utils/                     
│   │   ├── actions.py              # действия
│   │   ├── asserts.py              # проверки
│   │   └── __init__.py
│   ├── logger.py                   # конфигурация логирования
│   └── __init__.py
├── /report/                        # отчеты и артефакты (хранятся локально, должно быть подключено хранение в jenkins)
│   └── /logs/                      # логи выполнения тестов (pytest cli)
│         └── pytest_execution.log   
├── /docs/                          # документация
│   ├── PLAN.md                     # документация проекта, план автоматизации, тест-кейсы и история изменений
│   ├── CODE.md                     # описание стиля кода в проекте
│   ├── ARCH.md                     # описание вариантов архитектур проекта
│   ├── MD.md                       # описание markdown разметки
│   ├── IDE.md                      # описание работы в различных IDE и их настройки
│   ├── TERMINAL.md                 # описание работы в различных терминалах (cmd\unix\bash)
│   └── GIT.md                      # описание работы с git и bitbucket
├── pytest.ini                      # настройки pytest
├── runner.py                       # запускатор для тестовых прогонов
├── requirements.txt                # зависимости
├── README.md                       # описание проекта
└── .gitignore                      # игнор лист git
```
</p></details>

## Архитектура POM удобная
* Удобный формат директорий объединяющей все ресурсы page object модели модуля в одном месте

<details><summary>==[НАЖМИ]== Структура директорий</summary><p>

```
/Autotest-Project/                  # корневой каталог (репозиторий) проекта авто-тестов
├── /pages/                          # page object модели│ 
│   ├── base_page.py                # базовый page object класс (основные методы работы со страницей)
│   └── __init__.py
├── /test/                          # тестовые сценарии с группировкой по видам
│   ├── /smoke/                     # дымы (фронт)
│   │  ├── __int__.py   
│   │  └── test_smoke_orange.py
│   ├── /accept/                    # приемка (фронт)
│   │ 
│   ├── /api/                       # апи (бэк)
│   │   └── orange_playwright_api.py
│   ├── /load/                      # нагрузочное (locust)
│   │   ├── locust_orange.py
│   │   └── __init__.py 
│   ├── __init__.py  
│   └── conftest.py             # фикстуры pytest для конфигурации тестов и отчетности allure
├── /config/                        
│   ├── /utils/                     
│   │   ├── actions.py              # действия
│   │   ├── asserts.py              # проверки
│   │   └── __init__.py
│   ├── logger.py                   # конфигурация логирования
│   └── __init__.py
├── /report/                        # отчеты и артефакты (хранятся локально, должно быть подключено хранение в jenkins)
│   └── /logs/                      # логи выполнения тестов (pytest cli)
│         └── pytest_execution.log   
├── /docs/                          # документация
│   ├── PLAN.md                     # документация проекта, план автоматизации, тест-кейсы и история изменений
│   ├── CODE.md                     # описание стиля кода в проекте
│   ├── ARCH.md                     # описание вариантов архитектур проекта
│   ├── MD.md                       # описание markdown разметки
│   ├── IDE.md                      # описание работы в различных IDE и их настройки
│   ├── TERMINAL.md                 # описание работы в различных терминалах (cmd\unix\bash)
│   └── GIT.md                      # описание работы с git и bitbucket
├── pytest.ini                      # настройки pytest
├── runner.py                       # запускатор для тестовых прогонов
├── requirements.txt                # зависимости
├── README.md                       # описание проекта
└── .gitignore                      # игнор лист git
```
</p></details>

## Архитектура POM для нескольких проектов
* Проект содержится в отдельной папке test-projectname
* Есть возможность хранить несколько относительно независимых проектов в одной директории
<details><summary>==[НАЖМИ]== Структура директорий</summary><p>

```
/Autotest-Project/                  # корневой каталог (репозиторий) проекта авто-тестов
├── /pages/                          # page object модели│ 
│   ├── base_page.py                # базовый page object класс (основные методы работы со страницей)
│   └── __init__.py
├── /test/                          # тестовые сценарии с группировкой по видам
│   ├── /smoke/                     # дымы (фронт)
│   │  ├── __int__.py   
│   │  └── test_smoke_orange.py
│   ├── /accept/                    # приемка (фронт)
│   │ 
│   ├── /api/                       # апи (бэк)
│   │   └── orange_playwright_api.py
│   ├── /load/                      # нагрузочное (locust)
│   │   ├── locust_orange.py
│   │   └── __init__.py 
│   ├── __init__.py  
│   └── conftest.py             # фикстуры pytest для конфигурации тестов и отчетности allure
├── /config/                        
│   ├── /utils/                     
│   │   ├── actions.py              # действия
│   │   ├── asserts.py              # проверки
│   │   └── __init__.py
│   ├── logger.py                   # конфигурация логирования
│   └── __init__.py
├── /report/                        # отчеты и артефакты (хранятся локально, должно быть подключено хранение в jenkins)
│   └── /logs/                      # логи выполнения тестов (pytest cli)
│         └── pytest_execution.log   
├── /docs/                          # документация
│   ├── PLAN.md                     # документация проекта, план автоматизации, тест-кейсы и история изменений
│   ├── CODE.md                     # описание стиля кода в проекте
│   ├── ARCH.md                     # описание вариантов архитектур проекта
│   ├── MD.md                       # описание markdown разметки
│   ├── IDE.md                      # описание работы в различных IDE и их настройки
│   ├── TERMINAL.md                 # описание работы в различных терминалах (cmd\unix\bash)
│   └── GIT.md                      # описание работы с git и bitbucket
├── pytest.ini                      # настройки pytest
├── runner.py                       # запускатор для тестовых прогонов
├── requirements.txt                # зависимости
├── README.md                       # описание проекта
└── .gitignore                      # игнор лист git
```
</p></details>

## Различные варианты организации архитектур тестов под разные задачи
### Моно-архитектура
```
/test-project
├── conftest.py
└── ...
```
* Имеет flat структуру (плоскую, одно-уровневую) для Minimum Viable Product (MVP), Proof of Concept (PoC), тестирования, обучения
* Проект на ранней стадии, 1–2 модуля.
* Когда нет смысла тратить время на структуру — важно проверить гипотезу.

### Гибридная архитектура Semi-modular POM
```
/Autotest-Project/                  # корневой каталог (репозиторий) проекта авто-тестов
├── /pages/                          # page object модели│ 
│   ├── base_page.py                # базовый page object класс (основные методы работы со страницей)
│   └── __init__.py
├── /test/                          # тестовые сценарии с группировкой по видам
│   ├── /smoke/                     # дымы (фронт)
│   │  ├── __int__.py   
│   │  └── test_smoke_orange.py
│   ├── /accept/                    # приемка (фронт)
│   │ 
│   ├── /api/                       # апи (бэк)
│   │   └── orange_playwright_api.py
│   ├── /load/                      # нагрузочное (locust)
│   │   ├── locust_orange.py
│   │   └── __init__.py 
│   ├── __init__.py  
│   └── conftest.py             # фикстуры pytest для конфигурации тестов и отчетности allure
├── /config/                        
│   ├── /utils/                     
│   │   ├── actions.py              # действия
│   │   ├── asserts.py              # проверки
│   │   └── __init__.py
│   ├── logger.py                   # конфигурация логирования
│   └── __init__.py
├── /report/                        # отчеты и артефакты (хранятся локально, должно быть подключено хранение в jenkins)
│   └── /logs/                      # логи выполнения тестов (pytest cli)
│         └── pytest_execution.log   
├── /docs/                          # документация
│   ├── PLAN.md                     # документация проекта, план автоматизации, тест-кейсы и история изменений
│   ├── CODE.md                     # описание стиля кода в проекте
│   ├── ARCH.md                     # описание вариантов архитектур проекта
│   ├── MD.md                       # описание markdown разметки
│   ├── IDE.md                      # описание работы в различных IDE и их настройки
│   ├── TERMINAL.md                 # описание работы в различных терминалах (cmd\unix\bash)
│   └── GIT.md                      # описание работы с git и bitbucket
├── pytest.ini                      # настройки pytest
├── runner.py                       # запускатор для тестовых прогонов
├── requirements.txt                # зависимости
├── README.md                       # описание проекта
└── .gitignore                      # игнор лист git
```
* Команде нужно сохранить читаемость POM при ре-использовании кода между модулями.
* Количество модулей небольшое, но требуется изоляция логики.

### Domain-Driven Testing Architecture (DDD-influenced)
```
/Autotest-Project/                  # корневой каталог (репозиторий) проекта авто-тестов
├── /pages/                          # page object модели│ 
│   ├── base_page.py                # базовый page object класс (основные методы работы со страницей)
│   └── __init__.py
├── /test/                          # тестовые сценарии с группировкой по видам
│   ├── /smoke/                     # дымы (фронт)
│   │  ├── __int__.py   
│   │  └── test_smoke_orange.py
│   ├── /accept/                    # приемка (фронт)
│   │ 
│   ├── /api/                       # апи (бэк)
│   │   └── orange_playwright_api.py
│   ├── /load/                      # нагрузочное (locust)
│   │   ├── locust_orange.py
│   │   └── __init__.py 
│   ├── __init__.py  
│   └── conftest.py             # фикстуры pytest для конфигурации тестов и отчетности allure
├── /config/                        
│   ├── /utils/                     
│   │   ├── actions.py              # действия
│   │   ├── asserts.py              # проверки
│   │   └── __init__.py
│   ├── logger.py                   # конфигурация логирования
│   └── __init__.py
├── /report/                        # отчеты и артефакты (хранятся локально, должно быть подключено хранение в jenkins)
│   └── /logs/                      # логи выполнения тестов (pytest cli)
│         └── pytest_execution.log   
├── /docs/                          # документация
│   ├── PLAN.md                     # документация проекта, план автоматизации, тест-кейсы и история изменений
│   ├── CODE.md                     # описание стиля кода в проекте
│   ├── ARCH.md                     # описание вариантов архитектур проекта
│   ├── MD.md                       # описание markdown разметки
│   ├── IDE.md                      # описание работы в различных IDE и их настройки
│   ├── TERMINAL.md                 # описание работы в различных терминалах (cmd\unix\bash)
│   └── GIT.md                      # описание работы с git и bitbucket
├── pytest.ini                      # настройки pytest
├── runner.py                       # запускатор для тестовых прогонов
├── requirements.txt                # зависимости
├── README.md                       # описание проекта
└── .gitignore                      # игнор лист git
```
* Если команда использует DDD-подход в разработке.
* Проект сложный, бизнес-логики много, нужно думать в терминах бизнес-модулей (а не технических страниц).

### Что можно сделать
#### CI/CD
* Добавить папку /ci для скриптов запуска, конфигураций GitLab CI, Jenkins, GitHub Actions:
```
/ci
├── gitlab-ci.yml
├── jenkinsfile
└── run_tests.sh
```
#### Профили
* env/ или settings/ для многоконтурных запусков. Разные профили запуска (dev/stage/prod):
```
/config
├── env_dev.py
├── env_stage.py
└── env_prod.py
```
#### Запуск
* Интерфейс запуска тестов через CLI (например, click или typer)
* Добавь файл runtests.py или cli.py, через который можно удобно запускать тесты, получать отчёты и т.п.
#### Шаблоны/примеры
* Добавь в проект шаблоны написания тестов
```
/examples
└── example_test.py
```

### 🔴 ТО ДЕЛАТЬ НЕ НАДО
* Смешивать слои
  * ❌ Хранить тесты, POM, локаторы, данные и утилиты в одном модуле или папке (например, всё в test/ или utils/).
  * ❌ Размещать логику работы со страницей и тестовую логику в одном классе.
* Игнорировать базовые шаблоны
  * ❌ Отсутствие base_page.py, что ведёт к дублированию кода и сложной поддержке.
  * ❌ Отсутствие общих утилит для часто повторяющихся действий (например, переключения фреймов, ожиданий).
* Жёстко хардкодить
  * ❌ Хардкодить данные в тестах (особенно логины, пароли, данные карт).
  * ❌ Использовать time.sleep() вместо explicit wait.
  * ❌ Жестко прописывать URL-адреса в каждом тесте.
* Переиспользовать utils как свалку
  * ❌ Создавать "мусорную" папку utils, где хранятся и элементы UI, и фреймворки, и базовые действия, и общие переменные.
  * ❌ Хранить POM-классы или локаторы в utils.
* Делать тесную связку тестов и POM
  * ❌ Сильно завязывать тесты на структуру или логику POM, без возможности подмены или моков.
  * ❌ Не использовать абстракцию при работе со страницами.
* Повторять код между модулями
  * ❌ Дублировать одинаковые локаторы, данные или методы в разных POM-классах.
  * ❌ Не выносить общие компоненты (например, header, footer, модальные окна) в отдельные component POM.
* Игнорировать структуру отчетности
  * ❌ Не сохранять скриншоты при падении.
  * ❌ Не использовать интеграцию с Allure или хотя бы pytest-html.
  * ❌ Логирование только через print().
* Не использовать фикстуры или использовать их неправильно
  * ❌ Хардкодить browser = sync_playwright().start().chromium.launch() в каждом тесте.
  * ❌ Использовать глобальные переменные вместо фикстур pytest.
* Ограничиваться только UI тестами
  * ❌ Игнорировать API, когда есть возможность оптимизировать сценарий или ускорить сетап.
  * ❌ Проверять данные только через UI, когда быстрее и стабильнее через API или БД.
* Нарушать читаемость и поддержку
  * ❌ Длинные тестовые функции без описания шагов (без steps, assert, comments).
  * ❌ Отсутствие структуры и иерархии в папках, особенно при росте проекта.
  * ❌ Использовать нестандартные имена файлов и классов (page1, actions2, test1) — усложняет навигацию.
